# 机械臂示教角度配置系统

## 概述

本系统为机械臂控制节点提供了灵活的示教角度配置功能，通过YAML配置文件可以轻松管理和修改各种操作位置的关节角度。

## 配置文件

### 位置：`config/teach_angles.yaml`

配置文件包含以下主要部分：

#### 1. 放果位置 (place_fruit_position)
- **用途**：采摘完果实后放置到果篮
- **默认值**：`[0.0, -0.5, 0.0, -1.0, 0.0, 0.0]`
- **描述**：采摘完果实后放置到果篮的位置

#### 2. 抓取果篮位置 (grab_basket_position)
- **用途**：抓取果篮准备倾倒
- **默认值**：`[0.0, -0.8, 0.0, -1.2, 0.0, 0.0]`
- **描述**：抓取果篮准备倾倒的位置

#### 3. 倾倒果子位置 (dump_fruit_position)
- **用途**：倾倒果篮中的果实
- **默认值**：`[0.0, -1.0, 0.0, -0.8, 0.0, 0.0]`
- **描述**：倾倒果篮中果实的位置

#### 4. 果篮复原位置 (basket_return_position)
- **粗定位角度 (rough_position)**：果篮大致放回位置
  - **默认值**：`[0.0, -0.6, 0.0, -1.1, 0.0, 0.0]`
  - **描述**：果篮粗定位位置
- **精确放回角度 (precise_position)**：果篮精确放回位置
  - **默认值**：`[0.0, -0.55, 0.0, -1.05, 0.0, 0.0]`
  - **描述**：果篮精确放回位置

#### 5. 关节角度限制 (joint_limits)
- **用途**：定义各关节的角度范围
- **单位**：弧度制
- **范围**：`[-3.14, 3.14]` (约±180度)

#### 6. 运动参数 (motion_parameters)
- **默认速度**：0.5
- **默认加速度**：0.5
- **安全速度**：0.3
- **安全加速度**：0.3

## 使用方法

### 1. 启动节点

使用提供的启动文件：

```bash
roslaunch arm_control_node arm_control_with_config.launch
```

### 2. 修改配置

编辑 `config/teach_angles.yaml` 文件，修改相应的关节角度值：

```yaml
# 示例：修改安全位置角度
safe_position:
  joint_angles: [0.0, -1.2, 0.0, -1.8, 0.0, 0.0]  # 自定义角度
  description: "自定义安全位置"
```

### 3. 动态加载

修改配置文件后，重启节点即可加载新的配置。

## 代码集成

### 在代码中使用示教角度

```cpp
// 移动到放果位置
moveToJointAngles(place_fruit_joint_angles_);

// 移动到抓取果篮位置
moveToJointAngles(grab_basket_joint_angles_);

// 移动到倾倒果子位置
moveToJointAngles(dump_fruit_joint_angles_);

// 移动到果篮粗定位位置
moveToJointAngles(basket_return_rough_angles_);

// 移动到果篮精确放回位置
moveToJointAngles(basket_return_precise_angles_);
```

### 添加新的示教位置

1. 在配置文件中添加新的位置定义
2. 在头文件中添加对应的成员变量
3. 在 `loadTeachAngles()` 函数中添加加载逻辑

## 注意事项

1. **角度单位**：所有角度值使用弧度制
2. **关节数量**：确保角度数组包含6个值（对应6个关节）
3. **安全范围**：角度值应在关节限制范围内
4. **配置文件格式**：保持YAML格式的正确性

## 故障排除

### 常见问题

1. **配置文件加载失败**
   - 检查文件路径是否正确
   - 确认YAML格式语法正确
   - 查看ROS日志中的错误信息

2. **角度值异常**
   - 检查角度值是否在合理范围内
   - 确认角度数组长度是否为6
   - 验证数值格式是否正确

3. **节点启动失败**
   - 检查依赖服务是否可用
   - 确认配置文件路径正确
   - 查看启动日志中的错误信息

## 扩展功能

### 未来可能的改进

1. **动态配置更新**：支持运行时修改配置
2. **配置验证**：自动检查角度值的合理性
3. **配置备份**：自动备份和恢复配置
4. **可视化配置**：提供图形化配置界面
5. **配置版本管理**：支持多版本配置管理
